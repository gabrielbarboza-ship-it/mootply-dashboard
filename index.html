<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Mootply - Analytics</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <h1>Dashboard Mootply - Analytics</h1>
            <div class="header-date" id="current-date"></div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="navigation">
        <div class="container">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showOverview()">
                    <i class="fas fa-chart-pie"></i>
                    Overview Completo
                </button>
                <button class="nav-tab" onclick="showClientList()">
                    <i class="fas fa-list"></i>
                    Lista de Clientes
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Overview Section -->
            <section id="overview-section" class="overview-section">
                <!-- KPIs -->
                <div class="kpi-grid">
                    <div class="kpi-card">
                        <div class="kpi-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="kpi-content">
                            <h3>Total de Clientes</h3>
                            <p class="kpi-value">22</p>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="kpi-content">
                            <h3>Clientes Ativos</h3>
                            <p class="kpi-value">21</p>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="kpi-content">
                            <h3>Receita Total</h3>
                            <p class="kpi-value">R$49.335,00</p>
                        </div>
                    </div>
                    <div class="kpi-card">
                        <div class="kpi-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <div class="kpi-content">
                            <h3>Ticket Médio</h3>
                            <p class="kpi-value">R$2.349,29</p>
                        </div>
                    </div>
                </div>

                <!-- Charts Grid -->
                <div class="charts-grid">
                    <div class="chart-container" style="position: relative; height: 400px;">
                        <h3 class="chart-title">Distribuição por Objetivo</h3>
                        <canvas id="objectives-chart"></canvas>
                    </div>
                    <div class="chart-container" style="position: relative; height: 400px;">
                        <h3 class="chart-title">Distribuição por Plataforma</h3>
                        <canvas id="platforms-chart"></canvas>
                    </div>
                    <div class="chart-container" style="position: relative; height: 400px;">
                        <h3 class="chart-title">Top 10 Clientes</h3>
                        <canvas id="top-clients-chart"></canvas>
                    </div>
                    <div class="chart-container" style="position: relative; height: 400px;">
                        <h3 class="chart-title">Distribuição por Faixas de Verba</h3>
                        <canvas id="budget-distribution-chart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Client List Section -->
            <section id="client-list-section" class="client-list-section hidden">
                <!-- Search and Filters -->
                <div class="filters-section">
                    <div class="search-container">
                        <input 
                            type="text" 
                            id="search-input" 
                            placeholder="Buscar cliente por nome..."
                            class="form-control search-input"
                        >
                    </div>
                    <div class="filters-container">
                        <select id="objective-filter" class="form-control">
                            <option value="">Todos os Objetivos</option>
                        </select>
                        <select id="platform-filter" class="form-control">
                            <option value="">Todas as Plataformas</option>
                        </select>
                        <button class="btn btn--secondary" onclick="exportData()">
                            <i class="fas fa-download"></i>
                            Exportar Dados
                        </button>
                    </div>
                </div>

                <!-- Client List -->
                <div class="client-list-container">
                    <div class="client-list-header">
                        <div class="header-cell">Cliente</div>
                        <div class="header-cell">Objetivo</div>
                        <div class="header-cell">Plataforma</div>
                        <div class="header-cell">Verba</div>
                        <div class="header-cell">Analista</div>
                    </div>
                    <div id="client-list" class="client-list">
                        <!-- Client rows will be populated by JavaScript -->
                    </div>
                </div>

                <!-- No results -->
                <div id="no-results" class="no-results hidden">
                    <i class="fas fa-search"></i>
                    <p>Nenhum cliente encontrado com os filtros aplicados.</p>
                </div>
            </section>
        </div>
    </main>

    <!-- Client Detail Modal -->
    <div id="client-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-client-name">Detalhes do Cliente</h2>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="detail-sections">
                    <div class="detail-section">
                        <h3>Informações Gerais</h3>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <span class="detail-label">Cliente:</span>
                                <span class="detail-value" id="modal-client">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Objetivo Principal:</span>
                                <span class="detail-value" id="modal-objective">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Plataforma:</span>
                                <span class="detail-value" id="modal-platform">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Analista Responsável:</span>
                                <span class="detail-value" id="modal-analyst">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h3>Informações Financeiras</h3>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <span class="detail-label">Verba Líquida:</span>
                                <span class="detail-value budget" id="modal-budget">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">BV Mootply:</span>
                                <span class="detail-value" id="modal-bv">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h3>Investimento por Plataforma</h3>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <span class="detail-label">Google Ads:</span>
                                <span class="detail-value" id="modal-google-ads">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Meta Ads:</span>
                                <span class="detail-value" id="modal-meta-ads">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">TikTok Ads:</span>
                                <span class="detail-value" id="modal-tiktok-ads">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h3>Distribuição Diária</h3>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <span class="detail-label">Meta Dia/Verba:</span>
                                <span class="detail-value" id="modal-meta-daily">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Google Dia/Verba:</span>
                                <span class="detail-value" id="modal-google-daily">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
      fetch('https://raw.githubusercontent.com/gabrielbarboza-ship-it/mootply-dashboard/main/mootply-distribuicao-clientes.xlsx')
        .then(response => response.arrayBuffer())
        .then(data => {
          const workbook = XLSX.read(data, { type: "array" });
          const sheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[sheetName];
          const json = XLSX.utils.sheet_to_json(worksheet);
          console.log(json); // Conferir no console
          // Chame aqui as funções de atualização do dashboard usando "json"
        })
        .catch(error => console.error('Erro ao carregar Excel:', error));
    });
  </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="app.js"></script>
</body>
</html>
